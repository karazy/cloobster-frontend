<div ng-include="'partials/businesses_header.html'">
</div>
<div class="spots-wrapper">
	<div class="row-fluid">
		<div class="span12">
			<p l="areas.description">For each "cloobster location" you can add several "service areas" (like "Bar", "Rooms, "Spa", "Conference Area", etc.).<br>
				Each service area has different spots and a selection of product categories.</p>
		</div>
	</div>
	<div class="row-fluid">
		<!-- first column -->
		<div class="data-container-with-title span4">
			<h4 class="data-container-title" l="areas.list.title">Your service areas</h4>
			<div class="data-container-block data-container-seperator">
				<div class="row-fluid">
					<button class="btn btn-primary span6" ng-click="createArea()"><i class="icon-plus-sign icon-white"></i> <span l="common.new">New</span></button>
				</div>
			</div>
		<!-- 	<div class="loading-indicator" ng-show="areas == null">
			</div>
			<div ng-show="areas.length == 0">
				Keine Elemente
			</div> -->
			<ul class="nav nav-pills nav-stacked data-container-block data-container-large data-container-scrollable">
		        <li ng-repeat="area in areas | orderBy:['name'] " ng-class="{active: currentArea.id == area.id}">	        	
		        	<a ng-click="loadArea(area)">{{area.name}}  <i class="icon-ban-circle icon-black" ng-hide="area.active"></i></a>
		        </li>
		    </ul>	
		</div><!-- end first column -->

		<!-- 2. column -->
		<div class="span4" ng-show="currentArea">
			<div class="data-container-with-title">
				<h4 class="data-container-title" l="areas.detail.title">Edit Service Area</h4>
				<div class="data-container-block">
					<!-- <div class=" common-wrapper common-wrapper-detail-list" > -->

						<div simple-property-editor editor-title="areas.editor.name" editor-property="currentArea.name" editor-on-save="saveArea()" editor-max-length="20" editor-required>
							<h5 class="edit" tooltip="areas.editor.name.tooltip">{{currentArea.name}} <i class="icon-edit icon-black"></i></h5>
						</div>
						<div simple-property-editor editor-title="areas.editor.description" editor-property="currentArea.description" editor-on-save="saveArea()" editor-type="textarea">
							<p class="edit" tooltip="areas.editor.description.tooltip">{{currentArea.description}} <i class="icon-edit icon-black"></i></p>
						</div>
						<div class="row-fluid" ng-show="currentArea.id">
							<button class="btn btn-success span6" type="button" ng-click="toggleAreaActive()" ng-model="currentArea.active" ng-show="currentArea.active && currentArea.id"><i class="icon-ok icon-white"></i> <span l="common.active">Active</span></button>

			    			<button class="btn btn-danger span6" style="margin-left: 0px !important;" type="button" ng-click="toggleAreaActive()" ng-model="currentArea.active" ng-show="!currentArea.active && currentArea.id"><i class="icon-ban-circle icon-white"></i> <span l="common.inactive">Inactive</span></button>

							<button class="btn span6" data-toggle="modal" data-target="#deleteAreaModal"><i class="icon-trash"></i></button>
						</div>
						<div class="modal hide" id="deleteAreaModal">
						 	<div class="modal-header">
						    	<button type="button" class="close" data-dismiss="modal">×</button>
						    	<h3 l="areas.action.delete">Delete Area</h3>
							</div>
							<form name="areaDeleteForm" ng-submit="deleteArea(currentArea)" novalidate>
								<div class="modal-body alert-error">
							    	<p l="areas.dialog.delete.text">You're about to delete {{currentArea.name}}. The area and all spots will be deactivated for, all current checkins, will keep working, but now new checkins can be made at the correspoding spots. Data will be kept for a while until its will be deleted permanently.</p>
							    	<p l="dialog.delete.confirm">Please confirm your delete attempt by entering your password.</p>
						    		<label for="deletePassword" l="common.password">Password</label>
						    		<input type="password" id="deletePassword" name="deletePassword" ng-model="deletePassword" required></input>
						    		<span>{{deleteError}}</span>
							    </div>
							  	<div class="modal-footer">
							  		<button type="button" class="btn" data-dismiss="modal" l="common.cancel">Cancel</button>
							    	<button type="submit" class="btn btn-danger" ng-disabled="!deletePassword" l="common.delete">Delete</button>
								</div>
							</form>
						</div>
					<!-- </div> -->
				</div>
			</div>
			<!-- area spots list -->
			<div class="data-container-with-title" ng-show="currentArea.id">
				<h4 class="data-container-title" l="areas.spots.list.title">Spots</h4>
				<div class="data-container-block data-container-seperator">
					<p l="areas.spots.list.description">List of spots assigned to this area. </p>
					<!-- <div class="row-fluid show-grid"> -->
						<!-- <div class="row-fluid show-grid">
  							
						<button  class="btn btn-primary span6" ng-click="createSpot()"><i class="icon-plus-sign icon-white"></i> <span l="common.new">New</span></button>
						<a  class="btn btn-primary span6" href="#spotMassCreationDialog" data-toggle="modal" ng-click="spotMassCreation = null"><i class="icon-th icon-white"></i> <span l="spot.masscreation.button">Multiple</span></a>
							
						</div>	 -->					
					<!-- </div> -->
					<div class="btn-toolbar">						
						<div class="btn-group">						
							<button  class="btn" ng-click="checkSpots()" tooltip="spots.masscheck.tooltip">
								<i class="icon-check icon-black"></i>
							</button>						
						</div>
						<div class="btn-group">
						  <a class="btn btn-primary dropdown-toggle" data-toggle="dropdown" href="#">
						  	<span l="common.action">Action</span>
						    <span class="caret"></span>
						  </a>
						  <ul class="dropdown-menu">
						  	<li class="nav-header" l="spots.massupdate.list.header">
						  		Selected ...
						  	</li>
						  	<li>
						  		<a  class="" ng-click="setCheckedSpotsActiveState(true)">
									<i class="icon-ok icon-black"></i> <span>Aktiv setzen</span>
								</a>
						  	</li>						    
							<li>
								<a  class="" ng-click="setCheckedSpotsActiveState(false)">
									<i class="icon-ban-circle icon-black"></i> <span>Inaktiv setzen</span>
								</a>
							</li>							
							<li>
								<a  class="" data-toggle="modal" data-target="#deleteCheckedSpotsModal">
									<i class="icon-trash icon-black"></i> <span>Löschen</span>
								</a>
							</li>
							<li class="divider">
							</li>
							<li class="nav-header">
						  		Create ...
						  	</li>
							<li>
								<a  class="" ng-click="createSpot()">
									<i class="icon-plus-sign icon-black"></i> <span l="common.new">New</span>
								</a>
							</li>
							<li>
								<a  class="" href="#spotMassCreationDialog" data-toggle="modal" ng-click="spotMassCreation = null"><i class="icon-th icon-black"></i> <span l="spot.masscreation.button">Multiple</span></a>
							</li>
							
						  </ul>
						</div>
						<!-- <div class="btn-group">
							<button  class="btn btn-success" ng-click="setCheckedSpotsActiveState(true)" tooltip="spots.massactivate.tooltip">
								<i class="icon-ok icon-white"></i>
							</button>
							<button  class="btn btn-danger" ng-click="setCheckedSpotsActiveState(false)" tooltip="spots.massdeactivate.tooltip">
								<i class="icon-ban-circle icon-white"></i>
							</button>
							<button  class="btn btn" data-toggle="modal" data-target="#deleteCheckedSpotsModal" tooltip="spots.massdelete.tooltip">
								<i class="icon-trash icon-black"></i>
							</button>
						</div> -->					
		    			<div class="btn-group">
			    			<!-- <form class="form-inline">
		 						<div class="controls">  -->
			    					<div class="input-prepend" style="margin-bottom:0;">
		            					<span class="add-on"><i class="icon-search icon-black"></i>
		            					</span>
		            					<input l="common.search" type="text" l-attribute="placeholder" placeholder="Search" ng-model="spotsQuery.name" ng-change="">
		            					<i class="icon-remove icon-black" ng-click="spotsQuery = null">
		        						</i> 
		        					</div>
							<!-- 	</div>
			    			</form> -->
 			    			</div>
					</div>
					<span style="font-size: 10px;" l="spots.filtered.status">Spots count {{filteredSpots.length}} | checked {{getCheckedSpotsCount()}}</span>
					<div class="pull-right"><i class="icon-ban-circle icon-black"></i> <span l="spots.legend.inactive">Inactive</span></div>
				</div>
				<ul class="nav-pills-checkbox data-container-block data-container-small data-container-scrollable" id="spotsList">
				        <li ng-repeat="spot in filteredSpots = (spots | filter:spotsQuery) | orderBy:['name'] " >	        					        	
				        	<div ng-class="{active: currentSpot.id == spot.id}">
				        		<div>
				        			<input type="checkbox" ng-model="spot.checked">
				        		</div>
			        			<div ng-click="loadSpot(spot, $event)">{{spot.name}} <i class="icon-ban-circle icon-black" ng-hide="spot.active"></i></div>
			        			<!-- <a ></a> -->
			        		</div>
			        	</li>
		    	</ul>
			</div>
		</div>
		<!-- empty spot container placeholder -->
		<div class="span4" ng-hide="currentArea">
			<div class="data-container-with-title data-container-small data-container-inactive">
	    		<h4 class="data-container-title" l="areas.detail.title">Edit Service Area</h4>
	    		<div class="data-container-block">
	    			<p l="areas.container.empty.description">Shows the selected area details. Select an area from the list.</p>
	    		</div>
	    	</div>
		</div>
		<!-- spots detail -->
		<div class="span4" ng-show="currentSpot">
			<div class="data-container-with-title">
				<h4 class="data-container-title" l="areas.spot.detail.title">Edit Spot</h4>
				<div class="data-container-block">
					<div simple-property-editor editor-title="spots.editor.name" editor-property="currentSpot.name" editor-on-save="saveSpot()" editor-required editor-max-length="20">
							<h5 class="edit" tooltip="spots.editor.name.tooltip">{{currentSpot.name}} <i class="icon-edit icon-black"></i></h5>
						</div>
			    		<img ng-show="currentSpot.qrImageUrl" ng-src="{{currentSpot.qrImageUrl}}" alt="Spot Barcode"/>
			    		<p>{{currentSpot.barcode}}</p>
			    		<div class="row-fluid" ng-show="currentSpot.id">
			    			<button class="btn btn-success span6" type="button" ng-click="toggleSpotActive()" ng-model="currentSpot.active" ng-show="currentSpot.active && currentSpot.id"><i class="icon-ok icon-white"></i> <span l="common.active">Active</span></button>

			    			<button class="btn btn-danger span6" style="margin-left: 0px !important;" type="button" ng-click="toggleSpotActive()" ng-model="currentSpot.active" ng-show="!currentSpot.active && currentSpot.id"><i class="icon-ban-circle icon-white"></i> <span l="common.inactive">Inactive</span></button>

				    		<button class="btn span6" data-toggle="modal" data-target="#deleteSpotModal"><i class="icon-trash"></i></button>
				    		<!-- Modal delete dialog. -->
				    		<div class="modal hide" id="deleteSpotModal">
							 	<div class="modal-header">
							    	<button type="button" class="close" data-dismiss="modal">×</button>
							    	<h3 l="spot.action.delete">Delete Spot</h3>
								</div>
								<div class="modal-body alert-error">
							    	<p><span l="spot.action.delete.text">{{currentSpot.name}} will be deleted!<br/>Already printed barcodes can't be reused afterwards!</span></p>
							    </div>  
							  	<div class="modal-footer">
							  		<button type="button" class="btn" data-dismiss="modal" l="common.cancel">Cancel</button>
							    	<button type="button" class="btn btn-danger" data-dismiss="modal" ng-click="deleteSpot(currentSpot)" l="common.delete">Delete</button>
								</div>
							</div>
				    	</div>
				</div>
			</div>
		</div>
		<!-- empty spot container placeholder -->
		<div class="span4" ng-hide="currentSpot">
			<div class="data-container-with-title data-container-small data-container-inactive">
	    		<h4 class="data-container-title" l="areas.spot.detail.title">Edit Spot</h4>
	    		<div class="data-container-block">
	    			<p l="areas.spot.container.empty.description">Shows the selected spot details. Select a spot from the list.</p>
	    		</div>
	    	</div>
		</div>
	</div>
</div>
<!-- Modal to generate multiple spots -->
<div class="modal hide fade" id="spotMassCreationDialog">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
    <h3 l="spots.masscreation.title" >Spot mass creation dialog</h3>    
  </div>
  <div class="modal-body">
  	<p l="spots.masscreation.description">Here you can create multiple spots at once.</p>
    	<form class="form" name="spotMassCreationForm">
			<div class="control-group" ng-class="getFieldInputClass(spotMassCreationForm.massCreationName)">				
				<div class="controls">
					<label class="control-label" for="spots.masscreation.name" l="spots.masscreation.name">Name*</label>
					<div class="controls">
						<input id="spots.masscreation.name" name="massCreationName" type="text" l="spots.masscreation.placeholder.name" l-attribute="placeholder" placeholder="e.g. room or table" ng-model="spotMassCreation.name" required>
						<div class="help-inline" ng-show="spotMassCreationForm.massCreationName.$dirty && spotMassCreationForm.massCreationName.$invalid">
							<span ng-show="spotMassCreationForm.massCreationName.$error.required" l="propertyeditor.error.required">Required field</span>
						</div>
					</div>
				</div>
			</div>
			<div class="control-group">
				<div class="controls">
					<label class="control-label" for="spots.masscreation.startnumber" l="spots.masscreation.startnumber">Starting number</label>
					<div class="controls">
						<input type="number" id="spots.masscreation.startnumber" name="massCreationStartNumber" l="spots.masscreation.placeholder.startnumber" l-attribute="placeholder" placeholder="e.g. 100" ng-model="spotMassCreation.startNumber">
						<!-- <div class="help-inline" ng-show="spotMassCreationForm.massCreationName.$dirty && spotMassCreationForm.massCreationName.$invalid">
							<span ng-show="spotMassCreationForm.massCreationName.$error.required" l="propertyeditor.error.required">Required field</span>						
						</div> -->
					</div>
				</div>
			</div>
			<div class="control-group" ng-class="getFieldInputClass(spotMassCreationForm.massCreationCount)">
				<label class="control-label" for="spots.masscreation.count" l="spots.masscreation.count">Count*</label>
				<div class="controls">
					<input id="spots.masscreation.count" name="massCreationCount" type="number" l="spots.masscreation.placeholder.count" l-attribute="placeholder" placeholder="e.g. 50" ng-model="spotMassCreation.count" required min="1" max="500">
					<div class="help-inline" ng-show="spotMassCreationForm.massCreationCount.$dirty && spotMassCreationForm.massCreationCount.$invalid">
						<span ng-show="spotMassCreationForm.massCreationCount.$error.required" l="propertyeditor.error.number">Required field</span>
						<span ng-show="spotMassCreationForm.massCreationCount.$error.min" l="spots.masscreation.count.error.min">Min. number is 1</span>
						<span ng-show="spotMassCreationForm.massCreationCount.$error.max" l="spots.masscreation.count.error.max">Max. number is 500</span>
					</div>
				</div>
			</div>
		</form>
		<p l="registration.form.requiredfield">* marks required fields</p>
  </div>
  <div class="modal-footer">
  	<button class="btn" l="common.cancel" data-dismiss="modal" ng-click="spotMassCreation = null;">Cancel</button>
	<button class="btn btn-primary" l="common.save" ng-click="generateSpots()" ng-disabled="spotMassCreationForm.$invalid">Save</button>
  </div>
</div>

<!-- Modal delete dialog start -->
<div class="modal hide" id="deleteCheckedSpotsModal">
 	<div class="modal-header">
    	<button type="button" class="close" data-dismiss="modal">×</button>
    	<h3 l="spots.massdelete.title">Delete Selected Spots</h3>
	</div>
	<div class="modal-body alert-error">
    	<p><span l="spots.massdelete.description">Selected spots will be deleted.<br/>Already printed barcodes can't be reused afterwards!</span></p>
    </div>
  	<div class="modal-footer">
  		<button type="button" class="btn" data-dismiss="modal" l="common.cancel">Cancel</button>
    	<button type="button" class="btn btn-danger" data-dismiss="modal" ng-click="deleteCheckedSpots()" l="common.delete">Delete</button>
	</div>
</div>

